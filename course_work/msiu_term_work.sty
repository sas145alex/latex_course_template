% version   = "0.4" from 2017.12.06
\usepackage{cmap}
\usepackage[TS1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{indentfirst}%делать отступ в начале параграфа
\usepackage{amsmath,amssymb,amsfonts,amscd,amsthm}% расширенный набор матем. символов
\usepackage{bm}
\usepackage{color}% для использования цвета
\usepackage{graphicx} % для вставки рисунков
\usepackage{listingsutf8} % это лучше, чем verbatim
\usepackage{russmath} % для корректного переноса матем. формул
\usepackage{hyperref}
\usepackage{pgf}
\usepackage{listingsutf8} % это лучше, чем verbatim
\usepackage{tocvsec2}
% \usepackage{longtable}

% Дизэмуляция пакета, т.к. его и так уже использует класс memoir
% иначе пакет использовать не получится
\DisemulatePackage{setspace}
\usepackage{setspace}

\long\def\title#1#2#3#4#5#6#7{
  \mainmatter
  \noindent
  \thispagestyle{empty}

  \vspace*{-\headheight}\vspace*{-\headsep}

  \begin{center}
  \textsc{
    министерство образования и науки российской федерации\\
    \textbf{\small{федеральное государственное бюджетное образовательное\\
    учреждение высшего образования\\
    <<Московский политехнический университет>>}\\
    (<<МПУ>>)}\\
    Кафедра прикладной информатики\\
  }

  \vspace{4cm plus 1mm minus 1mm}


  {\LARGE\textbf{КУРСОВАЯ РАБОТА}}

  \vspace{1cm plus 1mm minus 1mm}

  {\large
    по дисциплине <<#1>>\\
    на тему <<#2>>\\

    \vfill

    \begin{tabular}{l}
    Группа\\
    \\
    Студент\\
    \\
    Руководитель работы\\
    #5\\
    \end{tabular}
    \hfill
    \begin{tabular}{l}
    #3\\
    \\
    #4\\
    \\
    \\
    #6\\
    \end{tabular}

    \vspace{3cm plus 1mm minus 1mm}

    Москва #7
  }

  \newpage

  % Обратная сторона титульного листа
  \setcounter{page}{2}

  \annotation{Аннотация}{\input{annotation}}

  \listofcontents{Содержание}

  \newpage

  \end{center}
}

\def\+{\hskip 0.15mm}

\lccode`\-=`\-\defaulthyphenchar=127 %перенос слов с дефисами

\emergencystretch=2pt
\hfuzz=0.8pt

%Размер страницы
\settrimmedsize{297mm}{210mm}{*} % a4paper: 297mm * 210mm%

% Оформление страницы
\pagestyle{plain}

%Размер текста
\settypeblocksize{46\baselineskip}{160mm}{*}
\setulmargins{*}{*}{1}
\setlrmargins{*}{*}{1}
\checkandfixthelayout
\typeoutlayout

\newcommand{\link}[1]{\texttt{#1}}

% Нумерация рисунков и таблиц сплошная по всему документу
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\theequation}{\arabic{equation}}
\addtodef{\mainmatter}{}{%
  \counterwithout{figure}{section}%
  \counterwithout{table}{section}%
  %\counterwithout{longtable}{section}%
}

% Оформление секций
\makeatletter
\renewcommand*{\thesection}{\@arabic\c@section.}
\setsecnumformat{\csname the#1\endcsname\space}
\makeatother

\renewcommand{\thesubsection}{\large\arabic{subsection}}
%\setsecheadstyle{\centering\scshape}
\setbeforesecskip{\onelineskip}
\setaftersecskip{0.6\onelineskip}

%В подписях к рисункам разделитель - точка
%\captiondelim{ }
\captiondelim{.\space}
%Уменьшенный шрифт для подписей
\captionnamefont{\small\itshape}
\captiontitlefont{\small}
% Пробел до и после рисунка
\setlength{\intextsep}{6mm}
%\setlength{\textfloatsep}{3mm}
%Пробел до и после подписи к рисунку
\setlength{\abovecaptionskip}{2mm}
\setlength{\belowcaptionskip}{0mm}
\changecaptionwidth\captionwidth{0.85\linewidth}

%Убираем большие расстояния по вертикали в списках
\tightlists

% Оформление списка литературы
\setbiblabel{#1)\hfill}
\renewcommand{\bibsection}{%
  \section*{Список литературы и интернет-ресурсов}
  \prebibhook
}






% Настроиваем абзацы (custom)
\setlength{\parskip}{10pt} % расстояние между абзацами
%\singlespacing
%\onehalfspacing
%\doublespacing
\setstretch{1.1} % for custom spacing


%% МАКРОСЫ
% Макрос для содержания
\newcommand{\listofcontents}[1]{
  \settocdepth{subsection} % отображение заголовков в содержании
  \renewcommand{\contentsname}{{\Large{#1}\hfill}}
  \tableofcontents*
}

% Макрос для аннотации
\newcommand{\annotation}[2]{
  \vspace*{1cm}
  \section*{#1}
  \begin{quote}
  #2
  \end{quote}
}

% Макрос для приложений
\renewcommand{\appendix}[2]{
  \newpage
  \settocdepth{section} % отображение заголовков в содержании
  \section{#1}
  #2
}
